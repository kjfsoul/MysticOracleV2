import{u as P,l as R,r as d,j as e,I as c,B as N,am as F,ar as C,T as D,m as B,n as k,p as S}from"./index-B2YqtOc4.js";import{a as L,s as T,z as g}from"./index-Dwn4jD2S.js";const E=g.object({email:g.string().email("Invalid email address"),password:g.string().min(6,"Password must be at least 6 characters")}),I=E.extend({username:g.string().min(3,"Username must be at least 3 characters"),confirmPassword:g.string()}).refine(o=>o.password===o.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function A({type:o}){var p,b,w,j,v,y;const{login:u,signup:h}=P();console.log("Auth functions available:",{login:!!u,signup:!!h});const{toast:n}=R(),[l,m]=d.useState(!1),[x,a]=d.useState(o);d.useEffect(()=>{a(o),console.log("Auth form type changed to:",o)},[o]);const i=L({resolver:T(E)}),r=L({resolver:T(I),defaultValues:{username:"",email:"",password:"",confirmPassword:""}});d.useEffect(()=>{console.log("Register form state:",{isDirty:r.formState.isDirty,isValid:r.formState.isValid,errors:r.formState.errors})},[r.formState]);const M=async s=>{m(!0);try{console.log("Attempting to login with:",{email:s.email});const t=await u(s.email,s.password);console.log("Login successful, user data:",t),n({title:"Success",description:"Logged in successfully"}),setTimeout(()=>{window.location.href="/"},1e3)}catch(t){console.error("Login error:",t),n({title:"Error",description:t instanceof Error?t.message:"Failed to login",variant:"destructive"})}finally{m(!1)}},f=async s=>{m(!0);try{if(console.log("Registering with:",{email:s.email,username:s.username}),s.password!==s.confirmPassword)throw new Error("Passwords do not match");console.log("Calling signup function with:",{email:s.email,password:"[REDACTED]",username:s.username});const t=await h(s.email,s.password,s.username);console.log("Signup result:",t),console.log("Registration successful, user data:",t),n({title:"Success",description:"Registered successfully"}),setTimeout(()=>{window.location.href="/"},1e3)}catch(t){console.error("Registration error:",t),n({title:"Error",description:t instanceof Error?t.message:"Failed to register",variant:"destructive"})}finally{m(!1)}};return e.jsx("div",{className:"space-y-6",children:o==="login"?e.jsx("form",{onSubmit:i.handleSubmit(M),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{...i.register("email"),type:"email",placeholder:"Email",error:(p=i.formState.errors.email)==null?void 0:p.message}),e.jsx(c,{...i.register("password"),type:"password",placeholder:"Password",error:(b=i.formState.errors.password)==null?void 0:b.message}),e.jsx(N,{type:"submit",className:"w-full",disabled:l,children:l?"Loading...":"Login"})]})}):e.jsx("form",{onSubmit:s=>{s.preventDefault(),console.log("Register form submitted");const t=r.getValues();console.log("Form data on submit:",t),r.handleSubmit(f)(s)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{...r.register("username"),placeholder:"Username",error:(w=r.formState.errors.username)==null?void 0:w.message}),e.jsx(c,{...r.register("email"),type:"email",placeholder:"Email",error:(j=r.formState.errors.email)==null?void 0:j.message}),e.jsx(c,{...r.register("password"),type:"password",placeholder:"Password",error:(v=r.formState.errors.password)==null?void 0:v.message}),e.jsx(c,{...r.register("confirmPassword"),type:"password",placeholder:"Confirm Password",error:(y=r.formState.errors.confirmPassword)==null?void 0:y.message}),e.jsx(N,{type:"button",className:"w-full",disabled:l,onClick:()=>{console.log("Register button clicked");const s=r.getValues();console.log("Form data:",s),r.trigger().then(t=>{console.log("Form validation result:",t),t?(console.log("Form is valid, submitting"),f(s)):console.log("Form is invalid, errors:",r.formState.errors)})},children:l?"Loading...":"Register"})]})})})}function z(){const{user:o,isLoading:u}=P(),[h]=F(),[n,l]=d.useState("login"),x=new URLSearchParams(h.split("?")[1]||"").get("tab"),a=x==="register"?"register":"login";return console.log("Tab parameter:",x,"Default tab:",a),n!==a&&l(a),d.useEffect(()=>{l(a),console.log("Auth page loaded with tab:",a),console.log("Auth page: checking if user is already authenticated")},[a]),!u&&o?e.jsx(C,{to:"/"}):e.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row bg-dark",style:{backgroundImage:`
             radial-gradient(circle at 10% 20%, rgba(74, 33, 116, 0.2) 0%, rgba(26, 26, 74, 0.1) 80%),
             url('https://images.unsplash.com/photo-1518818608552-195ed130cda4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80')
           `,backgroundBlendMode:"overlay",backgroundAttachment:"fixed",backgroundSize:"cover"},children:[e.jsx("div",{className:"w-full md:w-1/2 flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary border border-accent flex items-center justify-center",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6 text-accent",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("path",{d:"M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"})]})})}),e.jsx("h1",{className:"font-heading text-3xl font-bold mb-2 text-accent bg-gradient-to-r from-[#D4AF37] to-[#F5E1A4] bg-clip-text text-transparent",children:"Mystic Arcana"}),e.jsx("p",{className:"text-light/80",children:"Discover your cosmic destiny"})]}),e.jsx("div",{className:"bg-gradient-to-b from-primary/40 to-secondary/40 backdrop-blur-md rounded-xl border border-accent/30 p-6",children:e.jsxs(D,{value:n,defaultValue:a,className:"w-full",onValueChange:i=>{console.log("Tab changed to:",i),l(i),window.history.replaceState(null,"",`/auth?tab=${i}`)},children:[e.jsxs(B,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsx(k,{value:"login",children:"Sign In"}),e.jsx(k,{value:"register",children:"Sign Up"})]}),e.jsx(S,{value:"login",children:e.jsx(A,{type:"login"})}),e.jsx(S,{value:"register",children:e.jsx(A,{type:"register"})})]})})]})}),e.jsx("div",{className:"hidden md:flex md:w-1/2 bg-gradient-to-r from-primary/70 to-secondary/70 backdrop-blur-md p-12 items-center justify-center",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("div",{className:"mb-8 flex justify-center",children:e.jsx("div",{className:"w-24 h-24 rounded-full bg-dark/30 border-2 border-accent flex items-center justify-center",children:e.jsx("div",{className:"text-accent text-4xl rotate-12 transform transition-transform animate-pulse",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-12 h-12",children:[e.jsx("path",{d:"M12 22v-9"}),e.jsx("path",{d:"m15.4 10.7 1.1-11.3 1.3 3.2 2.7-2.1-.7 4.7 2.9 1.8-2.1 2 2.2 3-4.6-.3-.6 4-2.6-2-2.6 2-.6-4-4.6.3 2.2-3-2.1-2 2.9-1.8-.7-4.7 2.7 2.1 1.3-3.2 1.1 11.3"})]})})})}),e.jsx("h2",{className:"font-heading text-4xl font-bold mb-4 text-light",children:"Begin Your Mystical Journey"}),e.jsx("p",{className:"text-light/90 mb-6",children:"Unlock the ancient secrets of tarot and astrology with Mystic Arcana. Discover personalized insights through AI-powered readings, celestial charts, and mystical guidance."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-dark/20 backdrop-blur-sm rounded-lg p-4 border border-light/10",children:[e.jsx("div",{className:"text-accent text-xl mb-2",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6 mx-auto mb-2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m16 10-4 4-4-4"})]})}),e.jsx("h3",{className:"font-heading text-lg font-semibold text-light mb-1",children:"Tarot Readings"}),e.jsx("p",{className:"text-light/70 text-sm",children:"Interactive card spreads with deep insights"})]}),e.jsxs("div",{className:"bg-dark/20 backdrop-blur-sm rounded-lg p-4 border border-light/10",children:[e.jsx("div",{className:"text-accent text-xl mb-2",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6 mx-auto mb-2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}),e.jsx("path",{d:"M2 12h20"})]})}),e.jsx("h3",{className:"font-heading text-lg font-semibold text-light mb-1",children:"Astrology Charts"}),e.jsx("p",{className:"text-light/70 text-sm",children:"Personalized celestial forecasts"})]})]}),e.jsx("div",{className:"text-accent/80 text-sm italic",children:`"The cosmos holds answers to questions you haven't even thought to ask."`})]})})]})}export{z as default};
