import{u as S,r as n,j as e,as as j,ar as P}from"./index-C07lX9-t.js";var x={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function _(){const{signup:m}=S(),[i,g]=n.useState(!1),[a,r]=n.useState(null),[u,v]=n.useState("kevin"),[l,w]=n.useState("kjfsoul@gmail.com"),[c,E]=n.useState("Password123!"),[f,A]=n.useState("Password123!"),R=async s=>{if(s.preventDefault(),c!==f){r({type:"error",text:"Passwords do not match"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)){r({type:"error",text:"Please enter a valid email address"});return}if(c.length<8){r({type:"error",text:"Password must be at least 8 characters long"});return}g(!0),r({type:"info",text:"Processing registration..."});try{console.log("Registering with:",{email:l,name:u}),console.log("Using Supabase URL:",x.VITE_SUPABASE_URL),r({type:"info",text:"Connecting to Supabase..."}),r({type:"info",text:"Creating account..."});const{createClient:t}=j,o=x.VITE_SUPABASE_URL,h=x.VITE_SUPABASE_ANON_KEY;if(!o||!h){console.error("FATAL ERROR: Missing Supabase environment variables (VITE_SUPABASE_URL or VITE_SUPABASE_ANON_KEY) in .env file or environment."),r({type:"error",text:"Client configuration error. Cannot connect to authentication service."}),g(!1);return}const y=t(o,h),{data:p,error:b}=await y.auth.signUp({email:l,password:c,options:{data:{full_name:u}}});if(b)throw b;if(p.user){console.log("Signup successful, user:",p.user);try{const{error:d}=await y.from("users").insert([{id:p.user.id,email:l,created_at:new Date().toISOString()}]);d&&console.error("Error creating user record:",d)}catch(d){console.error("Error creating user record:",d)}}r({type:"success",text:"Registration successful! Redirecting to home page..."}),setTimeout(()=>{window.location.href="/"},2e3)}catch(t){console.error("Registration error:",t);let o="Registration failed";t.message&&(o=t.message),t.message&&t.message.includes("fetch")&&(o="Could not connect to the authentication server. Please check your internet connection and try again."),t.message&&t.message.includes("already registered")&&(o="This email is already registered. Please use a different email or try logging in."),t.message&&t.message.includes("invalid")&&(o="Please check your email and password. Email must be valid and password must be at least 8 characters."),r({type:"error",text:o})}finally{g(!1)}};return e.jsxs("div",{style:{width:"100%",maxWidth:"500px",backgroundColor:"white"},children:[e.jsx("h1",{style:{textAlign:"center",color:"#2a1a4a",marginTop:"20px",marginBottom:"5px"},children:"Mystic Arcana"}),e.jsx("p",{style:{textAlign:"center",color:"#666",marginBottom:"20px"},children:"Discover your cosmic destiny"}),e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #ccc"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",padding:"10px"},children:"Sign In"}),e.jsx("div",{style:{flex:1,textAlign:"center",padding:"10px",fontWeight:"bold"},children:"Sign Up"})]}),e.jsxs("form",{onSubmit:R,style:{padding:"20px"},children:[e.jsx("input",{type:"text",value:u,onChange:s=>v(s.target.value),placeholder:"kevin",style:{width:"100%",padding:"8px",marginBottom:"10px",border:"1px solid #ccc",boxSizing:"border-box"}}),e.jsx("input",{type:"email",value:l,onChange:s=>w(s.target.value),placeholder:"kjfsoul@gmail.com",style:{width:"100%",padding:"8px",marginBottom:"10px",border:"1px solid #ccc",boxSizing:"border-box"}}),e.jsx("input",{type:"password",value:c,onChange:s=>E(s.target.value),placeholder:"••••••",style:{width:"100%",padding:"8px",marginBottom:"10px",border:"1px solid #ccc",boxSizing:"border-box"}}),e.jsx("input",{type:"password",value:f,onChange:s=>A(s.target.value),placeholder:"••••••",style:{width:"100%",padding:"8px",marginBottom:"10px",border:"1px solid #ccc",boxSizing:"border-box"}}),e.jsx("button",{type:"submit",disabled:i,style:{width:"100%",padding:"10px",backgroundColor:"#333",color:"white",border:"none",cursor:i?"not-allowed":"pointer"},children:i?"Processing...":"Register"}),a&&e.jsx("div",{style:{padding:"10px",marginTop:"10px",borderRadius:"4px",backgroundColor:a.type==="error"?"#f8d7da":a.type==="info"?"#e2f3fd":"#d4edda",color:a.type==="error"?"#721c24":a.type==="info"?"#0c5460":"#155724"},children:a.text})]})]})}function B(){const{user:m,isLoading:i}=S();return!i&&m?e.jsx(P,{to:"/"}):e.jsx("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#2a1a4a"},children:e.jsx(_,{})})}export{B as default};
